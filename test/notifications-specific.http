### Variables
@baseUrl = http://localhost:3000
@contentType = application/json
@authToken = {{authToken}}

### 1. CREAR NOTIFICACIÓN MANUAL
POST {{baseUrl}}/notifications
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
  "message": "Notificación manual de prueba",
  "recommended_place": "Centro Comercial Santa Fe",
  "channel": "email",
  "location_data": {
    "city": "Bogotá",
    "coordinates": {
      "lat": 4.710989,
      "lng": -74.072092
    }
  }
}

> {%
    client.test("Create manual notification", function() {
        client.assert(response.status === 201, "Manual notification failed");
    });
%}

### 2. PROBAR CON COORDENADAS INVÁLIDAS
POST {{baseUrl}}/notifications/receive-location
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
  "lat": 100,  // Latitud inválida
  "lng": -200, // Longitud inválida
  "userId": "{{userId}}"
}

> {%
    client.test("Invalid coordinates", function() {
        client.assert(response.status === 400, "Should return 400 for invalid coordinates");
    });
%}

### 3. PROBAR SIN USER ID
POST {{baseUrl}}/notifications/receive-location
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
  "lat": 4.710989,
  "lng": -74.072092
}

> {%
    client.test("Missing user ID", function() {
        client.assert(response.status === 400, "Should return 400 for missing user ID");
    });
%}

### 4. OBTENER ESTADÍSTICAS DE COLA (solo admin)
GET {{baseUrl}}/notifications/queue/stats
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

> {%
    client.test("Queue stats", function() {
        // Puede devolver 200 o 400 dependiendo del rol del usuario
        client.log("Queue stats response: " + response.status);
    });
%}